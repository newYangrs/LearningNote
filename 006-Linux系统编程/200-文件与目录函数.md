## 文件与目录函数

### 1.stat/lstat函数

---

- 作用：返回文件有关的结构体信息

- stat可以穿透符号连接	硬链接

- lstat不会穿透符号连接

  ```c++
  #include<sys/stat.h>
  
  int stat(const char*path,struct stat*buf);
  
  返回值：
      成功，0
      失败，返回-1，并设置errono
  path：
      文件路径名
  buf：
      是一个传出参数
      Inode结构体指针，存放文件属性，常见操作有：
      	buf.st_size	获取文件大小
      	buf.st_mode	获取文件类型
      	buf.st_mode	获取文件权限
      
  ```
  
  
  
  



### 2.link/unlink/symlink/readlink函数

- 用于创建连接

  ```c++
  #include<unistd.h>
  
  //创建硬连接
  int link(const char*oldpath,const char*newpath);
  
  返回值：
      成功，0
      失败，-1
  
  //删除目录项
  int unlink(const char*pathname);	
  
  注意点：
      文件硬链接数为0时不会马上释放，等到所有打开该文件的进程终止时，系统才会挑时间释放
      
  隐式回收：
      所有进程结束时，释放申请的内存空间
  
  //创建符号连接
  int symlink(const char*oldpath,const char*newpath);		
  
  readlink f.soft		//读取符号链接本身
  
  ```

  





### 3.oepndir/closedir/readdir函数

```c++
#include<dirent>

//打开目录
DIR* open(const char*name);

返回值：
    成功，返回指向该目录的结构体指针
    失败，返回NULL
    
//关闭目录
DIR* closedir(DIR* drip);

返回值：
    成功，0
    失败，-1，设置errono

//读目录
struct dirent*readdir(DIR*dirp);

返回值：
    成功，返回目录项结构体指针
    失败，NULL，设置errono值

```









- 用目录函数实现ls命令


![1614132174098](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614132174098.png)



#### 目录递归功能的实现

- **方法一：**

![1614170599849](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614170599849.png)

![1614170390215](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614170390215.png)

- **方法二：**

![1614559374962](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614559374962.png)

![1614560123447](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614560123447.png)

![1614560164665](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614560164665.png)

![1614559853398](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614559853398.png)

![1614559911055](C:\Users\Mr.Yang\AppData\Roaming\Typora\typora-user-images\1614559911055.png)