### 进程间通信方式

![1617717200519](.Image/1617717200519.png)



### 1.pipe	管道函数(p430)

- 本质是内核空间中的一块缓冲区（4k大小）
- 环形队列缓冲区

```c++
#include<unistd.h>

int pipe(int fd[2]);

返回值：
    成功，0
    失败，-1
```



#### 管道的本质示意图

![1616546439632](.Image/1616546439632.png)







### 2.fifo	命名管道函数(p445)

```c++
#include<sys/stat.h>

int mkfifo(const char* path,mode_t mode);

返回值：
    成功，返回0
    失败，返回-1
```

#### 

![1616548100030](.Image/1616548100030.png)





![1616548339733](.Image/1616548339733.png)





![1616550557296](.Image/1616550557296.png)





![1616552235612](.Image/1616552235612.png)

![1616552317769](.Image/1616552317769.png)





![1616553552997](.Image/1616553552997.png)











![1616555004096](.Image/1616555004096.png)







### 3.mmap (p423) / munmap (p425)

- **mmap函数**：用于创建共享内存映射区

```c++
#include<sys/mman.h>
void* mmap(void* addr,size_t len,int prot,int flag,off_t off);

返回值:
	成功，返回映射去的起始地址
    失败，返回 MAP_FAILED
参数：
	addr:指定映射区首地址。 NULL，让系统自动分配
	len:映射区共享内存的大小（<=文件的实际大小）
    prot:设置映射区的读写权限
        	PROT_READ  PROT_WRITE  PROT_READ | PROT_WRITE
    flag:设置共享内存的共享属性
        	MAP_SHARED  MAP_PRIVATE
    fd:用于创建共享内存映射区的文件的描述符。权限需要是读才可以创建映射区
    off:设置偏移位置，需要是4k的整数倍
        默认0，表示映射文件全部
        
```

![1617717375830](.Image/1617717375830.png)





- **munmap：**释放映射区

```c++
#include<sys/mman.h>
int munmap(void* addr,size_t len);
```

- mmap/munmap 的使用实例

![1616725741251](.Image/1616725741251.png)



- mmap父子进程间通信

![1616810408911](.Image/1616810408911.png)

- 父子进程匿名通信

  ![1616813273015](.Image/1616813273015.png)

- 父子进程匿名通信

  ![1616813682166](.Image/1616813682166.png)



- 无血缘关系通信

  - 写

    ![1616813055690](.Image/1616813055690.png)

  

  - 读

    ![1616813015646](.Image/1616813015646.png)









