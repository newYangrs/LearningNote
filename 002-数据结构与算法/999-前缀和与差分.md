## 前缀和与差分

​					**——前缀和与差分互为逆运算**



### 一、一维前缀和

- **思路：**

  1. 存在序列  a~1~、a~2~、、、a~n~

     使得          s~i~=a~1~+a~2~+、、、+a~i~

     则               s~i~便是a~i~前缀和

  2. 作用，可在O(1)时间内求出a序列[l,r]区间的值，s~r~-s~l-1~

- **模板：**

  ```c++
  S[i] = a[1] + a[2] + ... a[i]
  a[l] + ... + a[r] = S[r] - S[l - 1]
  ```

  

### 二、二维前缀和

- **思路：**

  1. 将一维数组换成二维数组
  2. 二维前缀和数组存储a的前缀和
  3. 作用，可以求矩阵中的小矩阵和

- **模板：**

  ```c++
  S[i, j] = 第i行j列格子左上部分所有元素的和
  以(x1, y1)为左上角，(x2, y2)为右下角的子矩阵的和为：
  S[x2, y2] - S[x1 - 1, y2] - S[x2, y1 - 1] + S[x1 - 1, y1 - 1]
  ```

  



### 三、一维差分

- **思路：**

  1. 如果存在序列 a~1~、a~2~、、、a~n~

     构造				b~1~、b~2~、、、b~n~

     使得				a~i~=b+b~2~+、、、+b~i~

     则b~1~、b~2~、、、b~n~为a~1~、a~2~、、、a~n~的差分序列

     同时有			b~1~=a~1~

     ​						b~2~=a~2~-a~1~

     ​						、、、

     ​						b~n~=a~n~-a~n-1~

  2. 作用：如果想在a序列区间[l,r]中加上c，可b~l~+c，同时b~r+1~

- **模板：**

  ```c++
  给区间[l, r]中的每个数加上c：B[l] += c, B[r + 1] -= c
  ```

  



### 四、二维差分

- **思路：**

  1. 将一维数组换成二维数组即可

- **模板：**

  ```c++
  给以(x1, y1)为左上角，(x2, y2)为右下角的子矩阵中的所有元素加上c：
  S[x1, y1] += c, S[x2 + 1, y1] -= c, S[x1, y2 + 1] -= c, S[x2 + 1, y2 + 1] += c
  ```

  



